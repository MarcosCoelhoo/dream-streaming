(()=>{"use strict";function t(t){t.addEventListener("click",(function(t){t.preventDefault(),window.scrollTo({top:0,behavior:"smooth"});const{target:i}=t;!async function(t,i){const a=await(await fetch(`https://api.themoviedb.org/3/${i}/${t}?api_key=25ea17bf3ab54060fea05921b6061c3c&language=pt-BR&region=BR`)).json();var s;s={rate:a.vote_average.toFixed(1),year:a.release_date?a.release_date.slice(0,4):a.first_air_date.slice(0,4),backdrop:a.backdrop_path,type:i,title:a.title?a.title:a.name,genres:a.genres,time:"movie"===i?`${a.runtime}min`:`${a.number_of_seasons} season(s)`,id:t,overview:a.overview},function(){const{rate:t,year:i,backdrop:a,type:n,title:c,genres:r,time:o,id:l,overview:d}=s,h=document.querySelector(".section-midia .section-content");if(a){h.innerHTML=`\n      <div class="midia-image">\n      <div class="filter-image"></div>\n      <img src="https://image.tmdb.org/t/p/w780${a}" alt="">\n    </div>\n    <div class="midia-info">\n      <div class="midia-data">\n        <p class="data year">${i}</p>\n        <p class="data time">${o}</p>\n        <div class="rate data year">\n          <p>${t}</p>\n          <img src="./assets/icons/star.svg" alt="icon star rate" width="13px" height="13px">\n        </div>\n      </div>\n    \n      <h1 class="midia-title">${c}</h1>\n    \n      <ul class="midia-genres">\n           \n      </ul>\n    \n      <div class="midia-description">\n        <h2 class="section-title">Description</h2>\n    \n        <p class="description-text">${d}</p>\n      </div>\n    </div>\n      `;const s=document.querySelector(".section-midia .midia-genres");r.forEach((t=>{const e=document.createElement("li");e.innerHTML=`<p>${t.name}</p>`,s.appendChild(e)})),document.querySelector(".section-midia").classList.add("active"),document.title=`Dream | ${c}`,async function(t,i){const a=document.querySelector("#section-midia-similar .movie-list");a.children.length&&Array.from(a.children).forEach((t=>{a.removeChild(t)})),(await(await fetch(`https://api.themoviedb.org/3/${t}/${i}/similar?api_key=25ea17bf3ab54060fea05921b6061c3c&language=en&region=BR`)).json()).results.forEach((a=>{const s={rate:a.vote_average.toFixed(1),year:a.release_date?a.release_date.slice(0,4):a.first_air_date.slice(0,4),popularity:a.popularity,image:a.poster_path,type:t,id:i,title:"movie"===t?a.title:a.name};e("#section-midia-similar",s)}))}(n,l)}}(),document.querySelector(".back").addEventListener("click",(t=>{t.preventDefault();const e=document.querySelector(".section-midia");document.title="Dream",e.classList.remove("active")}))}(i.dataset.id,i.dataset.type)}))}class e{constructor(t,e){this.objMidiaInfo=e,this.idSection=t,this.parentMidiaList=document.querySelector(`${t} .movie-list`)}buildSection(){const{rate:e,popularity:i,year:a,image:s,id:n,type:c,title:r}=this.objMidiaInfo,o=r.replace(/[\s\W]+/g,"-").toLowerCase();if(s){const r=document.createElement("li");r.innerHTML=`\n    <a href='${o}.html' data-id='${n}' data-type='${c}'>\n  <div class="popular-image movie-image">\n  <img src="https://image.tmdb.org/t/p/w780${s}" alt="">\n</div>\n<div class="movie-content">\n  <div class="movie-rate">\n    <div class="rate">\n      ${e}\n      <img src="./assets/icons/star.svg" alt="icon star rate" width="13px" height="13px">\n    </div>\n  </div>\n\n  <div class="movie-info">\n    <div class="info-year">\n      ${a}\n    </div>\n    <div class="info-views">\n      <img src="./assets/icons/eye.svg" alt="" width="16px" height="16px">\n      <p>${i}</p>\n    </div>\n  </div>\n</div>\n</a>\n  `,this.parentMidiaList.appendChild(r),t(r.querySelector("a"))}}init(){return this.buildSection(),function(t){const e=document.querySelectorAll(`${t} [data-control]`),i=document.querySelectorAll(`${t} .movie-list li`),a=i.length;let s=0;function n({target:t}){"left"===t.dataset.control?s-=2:s+=2,s>=a&&(s=0),s<0&&(s=a-1),i.forEach((t=>t.classList.remove(".active"))),i[s].scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"}),i[s].classList.add("active")}i[s].classList.add("active"),e.forEach((t=>{t.addEventListener("click",n)}))}(this.idSection),this}}class i{constructor(t,e,i,a,s,n){this.baseUrl=t,this.apiKey=e,this.category=a,this.imageUrl=i,this.idSection=s,this.typeMidiaFetch=n}getDataMidia(t){return{rate:t.vote_average.toFixed(1),popularity:t.popularity,year:t.release_date?t.release_date.slice(0,4):t.first_air_date.slice(0,4),image:`${this.imageUrl}${t.poster_path}`,backdrop:`${this.imageUrl}${t.backdrop_path}`,id:t.id,type:this.typeMidiaFetch,title:t.title?t.title:t.name}}async startFetch(){(await(await fetch(`${this.baseUrl}/${this.typeMidiaFetch}/${this.category}?api_key=${this.apiKey}&page=1&language=pt-BR&region=BR`)).json()).results.forEach((t=>{const i=this.getDataMidia(t);new e(this.idSection,i).init()}))}init(){return this.startFetch(),this}}class a{constructor(t,e,i){this.element=t,this.events=e,this.callback=i,this.html=document.documentElement,this.outside="data-outside",this.handleOutsideClick=this.handleOutsideClick.bind(this)}handleOutsideClick({target:t}){this.element.contains(t)||(this.element.removeAttribute(this.outside),this.events.forEach((t=>{this.html.removeEventListener(t,this.handleOutsideClick)})),this.callback())}addEventsOutsideClick(){this.events.forEach((t=>{setTimeout((()=>{this.html.addEventListener(t,this.handleOutsideClick)})),this.element.setAttribute(this.outside,"")}))}init(){return this.element.hasAttribute(this.outside)||this.addEventsOutsideClick(),this}}const s="https://api.themoviedb.org/3",n="25ea17bf3ab54060fea05921b6061c3c",c="https://image.tmdb.org/t/p/w780";new i(s,n,c,"popular","#movie-popular","movie").init(),new i(s,n,c,"top_rated","#movie-top-rated","movie").init(),new i(s,n,c,"popular","#serie-popular","tv").init(),new i(s,n,c,"top_rated","#serie-top-rated","tv").init();const r=new class{constructor(t,e,i,a){this.baseUrl=t,this.imageUrl=i,this.apiKey=e,this.sectionLanding=document.querySelector(a),this.classItem="slide-container"}async buildLanding(){const t=+(3*Math.random()+1).toFixed(),e=await(await fetch(`${this.baseUrl}/movie/popular?api_key=${this.apiKey}&language=pt-BR&region=BR&page=${t}`)).json(),i=+(Math.random()*(e.results.length-1)).toFixed(),a=20*t+i,{vote_average:s,overview:n,release_date:c,backdrop_path:r,title:o}=e.results[i],l=document.createElement("li");l.classList.add(this.classItem),l.innerHTML=`\n      <div class="landing-content">\n              <div class="content-texts">\n              <p class="landing-info">#${a} Popular Movies</p>\n                <h1 class="landing-title">${o}\n                </h1>\n                <p class="landing-description">${n}</p>\n                <footer class="texts-footer">\n                  <p class="landing-date" data-landing="date">${c.slice(0,4)}</p>\n                  <div class="rate">\n                    ${s.toFixed(1)}\n                    <img src="./assets/icons/star.svg" alt="icon star rate" width="13px" height="13px">\n                  </div>\n                </footer>\n  \n              </div>\n              <div class="landing-button-container">\n                <a href="#" class="landing-button">\n                  watch now\n                  <img src="./assets/icons/play.svg" alt="icon play button" ">\n                  </a>\n                </div>\n              </div>\n              <div class="landing-image">\n                  <img src="${this.imageUrl}${r}" alt="poster of ${o}">\n              </div>\n    `,this.sectionLanding.appendChild(l)}init(){return this.buildLanding(),this}}(s,n,c,".landing-container .landing-list");r.init(),new class{constructor(t,e){this.btnMenu=document.querySelector(t),this.containerMenu=document.querySelector(e),this.events=["touchstart","click"],this.activeClass="active",this.openMenu=this.openMenu.bind(this)}openMenu(){this.btnMenu.classList.add(this.activeClass),this.containerMenu.classList.add(this.activeClass),new a(this.containerMenu,this.events,(()=>{this.btnMenu.classList.remove(this.activeClass),this.containerMenu.classList.remove(this.activeClass)})).init()}init(){this.btnMenu.addEventListener("click",this.openMenu)}}('[data-menu="button"]','[data-menu="container"]').init(),new class{constructor(t,e,i,a,s){this.containerSearch=document.querySelector(t),this.searchInput=document.querySelector(e),this.landingContainer=document.querySelector(i),this.mainContainerContent=document.querySelector(a),this.mainContainerSearch=document.querySelector(s),this.events=["touchstart","click"],this.activeClass="active",this.handleExpandSearch=this.handleExpandSearch.bind(this)}handleExpandSearch(){this.containerSearch.classList.add(this.activeClass),this.mainContainerSearch.classList.add(this.activeClass),this.mainContainerContent.classList.remove(this.activeClass),this.landingContainer.classList.remove(this.activeClass),new a(this.containerSearch,this.events,(()=>{this.containerSearch.classList.remove(this.activeClass),""===this.searchInput.value&&(this.mainContainerSearch.classList.remove(this.activeClass),this.landingContainer.classList.add(this.activeClass),this.mainContainerContent.classList.add(this.activeClass))})).init()}init(){return this.containerSearch.addEventListener("click",this.handleExpandSearch),this}}('[data-search="container"]','[data-search="container"] input',".landing-container","#main-content-container","#main-search-container").init()})();