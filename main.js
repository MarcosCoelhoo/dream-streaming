(()=>{"use strict";class t{constructor(t,e){this.objMidiaInfo=e,this.idSection=t,this.parentMidiaList=document.querySelector(`${t} .movie-list`)}buildSection(){const{rate:t,popularity:e,year:i,image:a,id:s,type:n,title:c}=this.objMidiaInfo,r=c.replace(/[\s\W]+/g,"-").toLowerCase();if(a){const c=document.createElement("li");c.innerHTML=`\n    <a href='${r}.html' data-id='${s}' data-type='${n}'>\n  <div class="popular-image movie-image">\n  <img src="https://image.tmdb.org/t/p/w780${a}" alt="">\n</div>\n<div class="movie-content">\n  <div class="movie-rate">\n    <div class="rate">\n      ${t}\n      <img src="./assets/icons/star.svg" alt="icon star rate" width="13px" height="13px">\n    </div>\n  </div>\n\n  <div class="movie-info">\n    <div class="info-year">\n      ${i}\n    </div>\n    <div class="info-views">\n      <img src="./assets/icons/eye.svg" alt="" width="16px" height="16px">\n      <p>${e}</p>\n    </div>\n  </div>\n</div>\n</a>\n  `,this.parentMidiaList.appendChild(c)}}init(){return this.buildSection(),function(t){const e=document.querySelectorAll(`${t} [data-control]`),i=document.querySelectorAll(`${t} .movie-list li`),a=i.length;let s=0;function n({target:t}){"left"===t.dataset.control?s-=2:s+=2,s>=a&&(s=0),s<0&&(s=a-1),i.forEach((t=>t.classList.remove(".active"))),i[s].scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"}),i[s].classList.add("active")}i[s].classList.add("active"),e.forEach((t=>{t.addEventListener("click",n)}))}(this.idSection),this}}class e{constructor(t,e){this.midiaLink=t,this.idSectionSimilar=e,this.getInfoMidia=this.getInfoMidia.bind(this)}async getDataMidia(e,i){const a=await(await fetch(`https://api.themoviedb.org/3/${i}/${e}?api_key=25ea17bf3ab54060fea05921b6061c3c&language=pt-BR&region=BR`)).json();var s,n;s={rate:a.vote_average.toFixed(1),year:a.release_date?a.release_date.slice(0,4):a.first_air_date.slice(0,4),backdrop:a.backdrop_path,type:i,title:a.title?a.title:a.name,genres:a.genres,time:"movie"===i?`${a.runtime}min`:`${a.number_of_seasons} season(s)`,id:e,overview:a.overview},n=this.idSectionSimilar,function(){const{rate:e,year:i,backdrop:a,type:c,title:r,genres:o,time:d,id:l,overview:h}=s,m=document.querySelector(".section-midia .section-content");if(a){m.innerHTML=`\n      <div class="midia-image">\n      <div class="filter-image"></div>\n      <img src="https://image.tmdb.org/t/p/w780${a}" alt="">\n    </div>\n    <div class="midia-info">\n      <div class="midia-data">\n        <p class="data year">${i}</p>\n        <p class="data time">${d}</p>\n        <div class="rate data year">\n          <p>${e}</p>\n          <img src="./assets/icons/star.svg" alt="icon star rate" width="13px" height="13px">\n        </div>\n      </div>\n    \n      <h1 class="midia-title">${r}</h1>\n    \n      <ul class="midia-genres">\n           \n      </ul>\n    \n      <div class="midia-description">\n        <h2 class="section-title">Description</h2>\n    \n        <p class="description-text">${h}</p>\n      </div>\n    </div>\n      `;const s=document.querySelector(".section-midia .midia-genres");o.forEach((t=>{const e=document.createElement("li");e.innerHTML=`<p>${t.name}</p>`,s.appendChild(e)})),document.querySelector(".section-midia").classList.add("active"),document.title=`Dream | ${r}`,async function(e,i){const a=document.querySelector("#section-midia-similar .movie-list");a.children.length&&Array.from(a.children).forEach((t=>{a.removeChild(t)})),(await(await fetch(`https://api.themoviedb.org/3/${e}/${i}/similar?api_key=25ea17bf3ab54060fea05921b6061c3c&language=en&region=BR`)).json()).results.forEach((a=>{const s={rate:a.vote_average.toFixed(1),year:a.release_date?a.release_date.slice(0,4):a.first_air_date.slice(0,4),popularity:a.popularity,image:a.poster_path,type:e,id:i,title:"movie"===e?a.title:a.name};new t(n,s).init()}))}(c,l)}}(),document.querySelector(".back").addEventListener("click",(t=>{t.preventDefault();const e=document.querySelector(".section-midia");document.title="Dream",e.classList.remove("active")}))}getInfoMidia(t){t.preventDefault(),window.scrollTo({top:0,behavior:"smooth"});const{target:e}=t,i=e.dataset.id,a=e.dataset.type;this.getDataMidia(i,a)}addEventMidia(){this.midiaLink.addEventListener("click",this.getInfoMidia)}init(){this.addEventMidia()}}class i{constructor(t,e,i,a,s,n){this.baseUrl=t,this.apiKey=e,this.category=a,this.imageUrl=i,this.idSection=s,this.typeMidiaFetch=n}getDataMidia(t){return{rate:t.vote_average.toFixed(1),popularity:t.popularity,year:t.release_date?t.release_date.slice(0,4):t.first_air_date.slice(0,4),image:`${this.imageUrl}${t.poster_path}`,backdrop:`${this.imageUrl}${t.backdrop_path}`,id:t.id,type:this.typeMidiaFetch,title:t.title?t.title:t.name}}async startFetch(){(await(await fetch(`${this.baseUrl}/${this.typeMidiaFetch}/${this.category}?api_key=${this.apiKey}&page=1&language=pt-BR&region=BR`)).json()).results.forEach((e=>{const i=this.getDataMidia(e);new t(this.idSection,i).init()})),document.querySelectorAll(`${this.idSection} .movie-list li a`).forEach((t=>{new e(t,"#section-midia-similar").init()}))}init(){return this.startFetch(),this}}class a{constructor(t,e,i){this.element=t,this.events=e,this.callback=i,this.html=document.documentElement,this.outside="data-outside",this.handleOutsideClick=this.handleOutsideClick.bind(this)}handleOutsideClick({target:t}){this.element.contains(t)||(this.element.removeAttribute(this.outside),this.events.forEach((t=>{this.html.removeEventListener(t,this.handleOutsideClick)})),this.callback())}addEventsOutsideClick(){this.events.forEach((t=>{setTimeout((()=>{this.html.addEventListener(t,this.handleOutsideClick)})),this.element.setAttribute(this.outside,"")}))}init(){return this.element.hasAttribute(this.outside)||this.addEventsOutsideClick(),this}}const s="https://api.themoviedb.org/3",n="25ea17bf3ab54060fea05921b6061c3c",c="https://image.tmdb.org/t/p/w780";new i(s,n,c,"popular","#movie-popular","movie").init(),new i(s,n,c,"top_rated","#movie-top-rated","movie").init(),new i(s,n,c,"popular","#serie-popular","tv").init(),new i(s,n,c,"top_rated","#serie-top-rated","tv").init();const r=new class{constructor(t,e,i,a){this.baseUrl=t,this.imageUrl=i,this.apiKey=e,this.sectionLanding=document.querySelector(a),this.classItem="slide-container"}async buildLanding(){const t=+(3*Math.random()+1).toFixed(),e=await(await fetch(`${this.baseUrl}/movie/popular?api_key=${this.apiKey}&language=pt-BR&region=BR&page=${t}`)).json(),i=+(Math.random()*(e.results.length-1)).toFixed(),a=20*t+i,{vote_average:s,overview:n,release_date:c,backdrop_path:r,title:o}=e.results[i],d=document.createElement("li");d.classList.add(this.classItem),d.innerHTML=`\n      <div class="landing-content">\n              <div class="content-texts">\n              <p class="landing-info">#${a} Popular Movies</p>\n                <h1 class="landing-title">${o}\n                </h1>\n                <p class="landing-description">${n}</p>\n                <footer class="texts-footer">\n                  <p class="landing-date" data-landing="date">${c.slice(0,4)}</p>\n                  <div class="rate">\n                    ${s.toFixed(1)}\n                    <img src="./assets/icons/star.svg" alt="icon star rate" width="13px" height="13px">\n                  </div>\n                </footer>\n  \n              </div>\n              <div class="landing-button-container">\n                <a href="#" class="landing-button">\n                  watch now\n                  <img src="./assets/icons/play.svg" alt="icon play button" ">\n                  </a>\n                </div>\n              </div>\n              <div class="landing-image">\n                  <img src="${this.imageUrl}${r}" alt="poster of ${o}">\n              </div>\n    `,this.sectionLanding.appendChild(d)}init(){return this.buildLanding(),this}}(s,n,c,".landing-container .landing-list");r.init(),new class{constructor(t,e){this.btnMenu=document.querySelector(t),this.containerMenu=document.querySelector(e),this.events=["touchstart","click"],this.activeClass="active",this.openMenu=this.openMenu.bind(this)}openMenu(){this.btnMenu.classList.add(this.activeClass),this.containerMenu.classList.add(this.activeClass),new a(this.containerMenu,this.events,(()=>{this.btnMenu.classList.remove(this.activeClass),this.containerMenu.classList.remove(this.activeClass)})).init()}init(){this.btnMenu.addEventListener("click",this.openMenu)}}('[data-menu="button"]','[data-menu="container"]').init(),new class{constructor(t,e,i,a,s){this.containerSearch=document.querySelector(t),this.searchInput=document.querySelector(e),this.landingContainer=document.querySelector(i),this.mainContainerContent=document.querySelector(a),this.mainContainerSearch=document.querySelector(s),this.events=["touchstart","click"],this.activeClass="active",this.handleExpandSearch=this.handleExpandSearch.bind(this)}handleExpandSearch(){this.containerSearch.classList.add(this.activeClass),this.mainContainerSearch.classList.add(this.activeClass),this.mainContainerContent.classList.remove(this.activeClass),this.landingContainer.classList.remove(this.activeClass),new a(this.containerSearch,this.events,(()=>{this.containerSearch.classList.remove(this.activeClass),""===this.searchInput.value&&(this.mainContainerSearch.classList.remove(this.activeClass),this.landingContainer.classList.add(this.activeClass),this.mainContainerContent.classList.add(this.activeClass))})).init()}init(){return this.containerSearch.addEventListener("click",this.handleExpandSearch),this}}('[data-search="container"]','[data-search="container"] input',".landing-container","#main-content-container","#main-search-container").init();const o=new class{constructor(t,e,i,a,s,n){this.idSection=t,this.searchInput=document.querySelector(e),this.sectionTitle=document.querySelector(i),this.movieList=document.querySelector(a),this.baseUrl=s,this.apiKey=n,this.fetchSearch=function(t,e){let i;return(...e)=>{i&&clearTimeout(i),i=setTimeout((()=>{t(...e),i=null}),200)}}(this.fetchSearch.bind(this))}async fetchSearch(){const e=this.searchInput.value,i=await(await fetch(`${this.baseUrl}/search/movie?api_key=${this.apiKey}&language=en&region=BR&query=${e}&include_adult=false`)).json();if(this.movieList.children.length){const t=[...this.movieList.children];this.sectionTitle.innerText="Search by movies",t.forEach((t=>{this.movieList.removeChild(t)}))}i.results.forEach((e=>{if(e.backdrop_path){const i={rate:e.vote_average.toFixed(1),popularity:e.popularity,year:e.release_date.slice(0,4),backdrop:e.backdrop_path,image:e.poster_path,id:e.id,type:"movie",title:e.title};new t(this.idSection,i).init()}}))}addEventSearch(){this.searchInput.addEventListener("keyup",this.fetchSearch)}init(){return this.addEventSearch(),this}}("#main-search-container",'[data-search="container"] input',"#main-search-container .section-title","#main-search-container .movie-list",s,n);o.init()})();